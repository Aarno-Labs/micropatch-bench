1058,1059c1058,1067
<    fdat = fits_decode_card (fits_search_card (hdr, "XTENSION"), typ_fstring);
<    strcpy (hdulist->xtension, fdat->fstring);
---
>      fdat = fits_decode_card (fits_search_card (hdr, "XTENSION"), typ_fstring);
>      if (fdat != NULL)
>        {
>          strcpy (hdulist->xtension, fdat->fstring);
>        }
>      else
>        {
>          strcpy (errmsg, "No valid XTENSION header found.");
>          goto err_return;
>        }
